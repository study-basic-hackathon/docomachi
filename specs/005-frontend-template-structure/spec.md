# Feature Specification: フロントエンドのフォルダ構成をテンプレートに合わせる

**Feature Branch**: `005-frontend-template-structure`  
**Created**: 2026-02-20  
**Status**: Draft  
**Input**: フロントエンドのフォルダ構成もテンプレートに合わせるようにしてください。大きな変更になっても構いません。

## Clarifications

### Session 2026-02-20

- Q: アプリルートの位置は、リポジトリルートに合わせるか frontend/ のままにするか？ → A: リポジトリルートをアプリルートにする（frontend の中身をリポジトリルートへ移し、テンプレートと完全に同じ「ルート直下に app/, public/」にする）。

## User Scenarios & Testing *(mandatory)*

### User Story 1 - テンプレートと同一のディレクトリ構成 (Priority: P1)

開発者・デプロイ担当者がリポジトリを開いたとき、参照テンプレート（amplify-next-template）と同一のディレクトリ・ファイル配置になっており、ページや静的アセット、設定ファイルの置き場所がテンプレートと一致していること。

**Why this priority**: 構成を揃えることで、Amplify のビルドやドキュメント・サンプルとの対応が取りやすくなり、デプロイ失敗やパス不整合を防ぐ。

**Independent Test**: テンプレートのリポジトリ構造一覧と当プロジェクトのフロントエンド部分を比較し、ルートからの相対パスで「アプリのルート」「ページ用ディレクトリ」「公開用静的ディレクトリ」「ビルド設定ファイル」の位置が一致していることを確認できる。

**Acceptance Scenarios**:

1. **Given** 参照テンプレートではアプリのルート直下にページ用ディレクトリ（例: `app/`）と公開用ディレクトリ（例: `public/`）がある、**When** 当プロジェクトのフロントエンド構成を確認する、**Then** 同じ名前・同じ相対位置に相当するディレクトリが存在する。
2. **Given** テンプレートではビルド設定ファイルがアプリルート直下にある、**When** 当プロジェクトのフロントエンドを確認する、**Then** 同等の設定ファイルがアプリルート直下（またはテンプレートと同等の位置）に存在する。

---

### User Story 2 - ビルド・デプロイの継続動作 (Priority: P2)

構成変更後も、ローカルでのビルドおよび Amplify でのデプロイが従来どおり成功し、アプリのトップが表示されること。

**Why this priority**: 構成変更によってビルドやデプロイが壊れないことが必須である。

**Independent Test**: 構成変更後にローカルでビルドを実行し、Amplify でデプロイを実行して、成果物が正しく生成されアプリURLで表示されることを確認できる。

**Acceptance Scenarios**:

1. **Given** フォルダ構成をテンプレートに合わせた状態、**When** アプリのビルドコマンドを実行する、**Then** ビルドが成功し、成果物が期待される出力先に生成される。
2. **Given** 上記のビルド成果物、**When** Amplify でデプロイする、**Then** デプロイが完了し、発行URLでアプリのトップが表示される。

---

### Edge Cases

- テンプレートにないディレクトリ（例: 既存の `src/components`、`tests`）は、テンプレートに合わせた構成のうえで、必要なものはテンプレートで許容される位置（例: アプリルート直下のサブディレクトリ）に配置するか、移行・統合する。
- アプリルートはリポジトリルートに統一する（Clarifications で決定）。Amplify のルートディレクトリはリポジトリルートに設定し、amplify.yml はテンプレート同様にルートで `npm run build`・成果物 `.next` とする。
- 既存のページ・コンポーネント・スタイル・テストは、構成変更後も動作し、参照パスやインポートが切れないこと。

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: フロントエンドのディレクトリ構成は、参照テンプレートと同一のレイアウトとする。**アプリルートはリポジトリルート**とし、ルート直下にページ用ディレクトリ（`app/`）、公開用ディレクトリ（`public/`）、およびビルド・型設定ファイル（`package.json`、`next.config.js`、`tsconfig.json`、`next-env.d.ts` 等）を配置する。frontend 配下の資産はルートへ移す。
- **FR-002**: 既存のページ・コンポーネント・静的アセット・スタイルは、上記構成に移行した後も動作し、ビルドが成功すること。
- **FR-003**: 構成変更後、Amplify のビルド設定（amplify.yml やルートディレクトリ設定）と整合し、デプロイが「Artifact directory doesn't exist」等で失敗しないこと。
- **FR-004**: テンプレートに存在しないがプロジェクトで必要な要素（テスト用ディレクトリ、共有コンポーネント等）は、テンプレートの構成を崩さない範囲で配置する。

### Key Entities

- **アプリルート**: フロントエンドのビルド対象となるルート。本機能では **リポジトリルートをアプリルートとする**（frontend の中身をルートへ移し、テンプレートと同様にルート直下に `app/`・`public/` を置く）。
- **ページ用ディレクトリ**: ルーティング・ページを格納するディレクトリ。テンプレートでは `app/`（App Router）。リポジトリルート直下の `app/` とする。
- **公開用ディレクトリ**: 静的ファイルを配信するためのディレクトリ。テンプレートでは `public/`。リポジトリルート直下の `public/` とする。

## Assumptions

- 参照テンプレートは [aws-samples/amplify-next-template](https://github.com/aws-samples/amplify-next-template) とする。テンプレートのフロントエンドはリポジトリルートに `app/`、`public/`、`package.json`、`next.config.js`、`tsconfig.json`、`next-env.d.ts` がある構成である。
- **アプリルートはリポジトリルートとする**（Clarifications で決定）。frontend 配下のソース・設定・依存をリポジトリルートへ移し、ルート直下に `app/`、`public/`、およびビルド・型設定ファイルを配置する。`frontend/` ディレクトリは廃止するか、移行後の整理対象とする。
- 既存の Amplify のルートディレクトリ設定および amplify.yml は、本変更後は **ルートをリポジトリルート（空または `/`）に変更** し、テンプレート同様に `cd` なしの `npm run build` と成果物 `.next` に合わせる。構成変更と設定の整合は本機能の範囲に含む。

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: テンプレートのディレクトリ一覧と照合したとき、アプリルート直下に `app/`（または同等）、`public/`、および主要な設定ファイルが存在し、テンプレートと一致する。
- **SC-002**: 構成変更後にローカルでビルドを実行し、成功すること。
- **SC-003**: 構成変更後に Amplify でデプロイを実行し、デプロイが完了し、発行URLでアプリのトップが表示されること。
- **SC-004**: 既存のトップページおよび主要な画面・機能が、構成変更後も表示・動作すること。
